# 云架构师认证

## 架构设计

### 高可用

采用合理的成本来选择和组合云产品，以满足业务需求的同时，提高系统可用性，可扩展性以及安全性

可用性： 计算机系统能够持续无故障正常运行的概率。在互联网业务里面，一般指平均能够正常的为用户提供服务的概率

```
MTTF = (MTTF + MTTR) * 100%
```

| 级别         |      | 可用性  | 故障时长 |
| ------------ | ---- | ------- | -------- |
| 基本可用性   | 2个9 | 99%     | 87.6小时 |
| 较高可用性   | 3个9 | 99.9%   | 8.8小时  |
| 故障自动恢复 | 4个9 | 99.99%  | 53分钟   |
| 极高可用性   | 5个9 | 99.999% | 5分钟    |

#### 设计原则

围绕着如何提高可用性，通过评估分级、冗余设计以及伸缩性来提升MTTF，降低MTTR

##### 评估分级

国际上对于灾难恢复能力及业务恢复能力的指标：

|          | 容灾登记 | RTO        | RPO        |
| -------- | -------- | ---------- | ---------- |
| 初期目标 | 1级      | >=2天      | 1~7天      |
|          | 2级      | >=24小时   | 1~7天      |
|          | 3级      | >=12小时   | 1~7天      |
|          | 4级      | 几分钟~2天 | 几小时~1天 |
| 最终目标 | 5级      | 几分钟~2天 | 0~30分钟   |
|          | 6级      | 几分钟     | 0          |

评估分级需求：

* 时间段内可用性时间要求，含计划与非计划停机时间
* 业务量指标及响应时间要求
* 特殊时间段可用性要求

##### 冗余设计

从网络、存储、计算三个方面考虑，将单节点单通道进化为多节点多通道

常见的模式：

* 主从模式（数据库）
* 双机双工
* 集群模式

##### 伸缩性

纵向扩展： 增加对应的配置

横向扩展：增加对应的实例

#### 腾讯云高可用服务

* 硬件支持    腾讯云机房遍布全球，实现了完备的容灾策略，选用高质量的IDC机房实现多运营商接入，高标准的机房网络建设
* 平台支持    虚拟化技术，数据冗余存储，数据中心内实例自动故障迁移
* 高可用组件  腾讯云提供双机热备（如数据库、NAT网关）、分布式（如SCF、云缓存）等高可用设计

| 类型      | 产品                                                         |
| --------- | ------------------------------------------------------------ |
| 存储      | 对象存储、文件存储、归档存储、云硬盘                         |
| 数据库    | 关系型数据库、弹性缓存、HTAP数据库、时序数据库、分布式数据库、列式数据库 |
| 网络      | NAT网关、云解析                                              |
| 中间件    | 负载均衡、消息队列、API网关、分布式服务框架                  |
| CDN与加速 | 静态内容加速、动态加速网络、下载分发加速、视音频点播加速     |

* 高可用架构   两地三中心、负载均衡、弹性伸缩

### 高扩展

扩展性是指业务IT系统，应对业务变更和功能变化时，调整的难易程度，用来保障系统适应调整的能力。这里的扩展性指系统扩展性，并非指代码的扩展性。

系统扩展性高：

* 修改模块功能，不对其他模块产生影响
* 新增或减少功能模块，不对原有架构体系产生冲击
* 业务变更与上线，开发团队轻松应对

#### 设计原则

* 使用标准的云组件
* 微服务化

方向：

* 使用消息队列异步化改造
  * 梳理业务逻辑的关键路径，拆离非关键逻辑
  * 将分布式事务异步化处理
  * 利用消息队列的存储转发功能
  * 使用消息队列的订阅功能
* 减少自建的通用型服务
  * 腾讯云服务集群化及扩缩容能力
  * 腾讯云服务是标准化和高度抽象的，不会涉及具体的业务逻辑
  * 腾讯云服务提供标准化的接口，降低数据依赖，提高扩展性
* 计算和数据分离
  * Session、token等应存放在高速缓存组件中，不应存放在计算服务器中
  * 计算与数据分离，才能避免数据耦合，支持计算能力的弹性伸缩

### 高安全

目的：

* 业务连续性和安全性
* 数据不丢失
* 数据不泄露

包含主机安全、网络安全、数据安全、应用安全、业务安全

#### 主机安全

风险：

* 木马攻击
* 密码破解
* 漏洞攻击

策略：

* 制定合理的补丁更新策略
* 定期漏洞扫描
* 安装安全防护软件
* 关闭或过滤高危端口

#### 网络安全

风险：

* DDos攻击
* XSS攻击
* 注入攻击
* CC攻击
* CSRF攻击

策略：

* 流量清洗
* 定期漏洞扫描
* 网络隔离，防止损失扩大

#### 数据安全

风险：

* 数据泄露   因员工疏忽或系统故障
* 数据窃取   嗅探攻击、中间人攻击

策略：

* 按最低权限原则分配访问和操作权限
* 进行数据加密

#### 业务和应用安全

风险：

* 羊毛党
* 金融欺诈
* 应用漏洞

策略：

* 设计防刷策略
* 借助腾讯云产品识别用户画像
* 加强应用防护，修复漏洞

#### 腾讯云高安全服务

| 安全类别 | 安全产品/服务                                           |
| -------- | ------------------------------------------------------- |
| 网络安全 | VPC、安全组、大禹、网站管家WAF                          |
| 业务安全 | 天御（活动防刷AA）                                      |
| 应用安全 | 应用安全MS                                              |
| 主机安全 | 云镜                                                    |
| 数据安全 | 密钥管理服务KMS、数据加密服务HSM、访问管理CAM、云审计CA |

